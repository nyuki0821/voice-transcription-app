## VoiceInsight Cloud - MVP開発ロードマップ (GCP版)

### 基本アーキテクチャ方針
本ロードマップでは、GCP (Google Cloud Platform) を主要クラウド基盤とし、サーバーレスアーキテクチャを中心に構築を進めます。データベースにはFirestoreを採用し、スプレッドシートへの依存は初期段階から解消します。ファイルストレージはCloud Storage、サーバーレス処理はCloud Functions (Gen2) およびCloud Run、認証・ホスティングにはFirebaseの各種サービスを活用します。

### フェーズ0: 現状分析およびGCP基盤準備 (期間: 約0.5ヶ月)

**目標:**
*   既存システム（`README.md`記載のZoom Phone連携、OpenAI Whisper・GPT-4o-mini活用、現行Cloud Functions等）のGCP環境への移行計画を策定する。
*   GCPプロジェクトのセットアップ、必要APIの有効化、IAM権限設定等の基盤構築を完了する。
*   既存Cloud Functionsのロジックのうち、再利用可能な部分とGCPのベストプラクティスに基づき改修が必要な部分を明確化する。

**主要タスク:**
1.  **既存コード資産評価 (GCP移行観点):** `README.md`記載の `ZoomphoneProcessor.js` (GAS)、`TranscriptionPipeline` (GAS)、`cloud_function/index.js` (現行Cloud Functions)を対象に、Cloud Functions (Gen2) またはCloud Runへの移行戦略を策定する。
2.  **APIキーおよび認証情報確認:** OpenAI, Zoom APIの有効なキー、およびGCPサービスアカウントの準備状況を確認する。
3.  **GCPプロジェクト初期設定:** 新規または既存GCPプロジェクトにおいて、Cloud Storage, Firestore, Cloud Functions, Cloud Run, Pub/Sub, Cloud Logging, Cloud Monitoring API等を有効化し、初期設定を実施する。

---

### フェーズ1: コア処理パイプラインMVP構築 (期間: 約1ヶ月)

**目標:**
*   Zoom Phone録音の自動取り込み、文字起こし、基本分析（既存ロジックベース）、結果保存までのコア処理パイプラインをGCPサーバーレス環境で構築する。
*   Firestoreをデータストアとして利用し、スプレッドシート依存を完全に排除する。

**主要機能とアーキテクチャ要素:**
1.  **1-1: 録音データ自動取り込みパイプライン構築:**
    *   **機能:** Zoom PhoneからのWebhook (`recording_completed`) 受信、録音ファイルのCloud Storageへの直接保存、関連メタ情報 (ファイル名、日時、通話相手情報等) のFirestoreへの記録。
    *   **アーキテクチャ:**
        ```mermaid
        graph LR
            A[Zoom Phone] --> B[Cloud Functions - Webhook Receiver]
            B --> C[Cloud Storage]
            B --> D[Firestore - Recordings Collection]
        ```
2.  **1-2: 文字起こし・基本分析処理パイプライン構築:**
    *   **機能:** Cloud Storageへのファイル保存をトリガーとしたCloud Functionsの実行。既存のOpenAI Whisper・GPT-4o-mini連携ロジックを利用した文字起こしと基本情報抽出。処理結果 (文字起こしテキスト、抽出情報) のFirestoreへの保存。
    *   **アーキテクチャ:**
        ```mermaid
        graph LR
            C[Cloud Storage] --> E[Cloud Functions - Transcription & Analysis]
            E --> F[OpenAI Whisper API]
            E --> G[OpenAI GPT-4o-mini API]
            E --> H[Firestore - AnalysisResults Collection]
        ```
3.  **1-3: 基本ファイルステータス管理とエラーログ記録:**
    *   **機能:** 各処理ステップ (ファイル取得、文字起こし、分析) のステータスをFirestoreで管理。基本エラー発生時のCloud Loggingへのログ記録。

**技術スタック (GCP):** Cloud Functions (Gen2), Cloud Storage, Firestore, Cloud Logging.
**このフェーズにおける主要評価指標 (KPI):** コアパイプラインの正常稼働率、データ処理のレイテンシ、Firestoreへのデータ整合性。

---

### フェーズ2: 社内向けデータ活用MVPとフィードバック収集 (期間: 約1〜1.5ヶ月)

**目標:**
*   社内ユーザーが処理結果データを確認・活用できる基本的なWebアプリケーションとダッシュボードを構築する。
*   社内での実運用を通じて、コア機能のユーザビリティと有効性に関するフィードバックを収集し、改善点を洗い出す。
*   基本的なファイルエラーハンドリングと手動復旧の仕組みを導入する。

**主要機能とアーキテクチャ要素:**
1.  **2-1: 社内向けWebアプリケーションおよび基本ダッシュボード開発:**
    *   **機能:** Firestoreに保存された文字起こし結果や分析結果を一覧表示・検索できるシンプルなWebアプリケーション。主要KPI（日次処理件数、エラー件数等）を表示する基本ダッシュボード。必要に応じたCSVエクスポート機能。
    *   **アーキテクチャ:**
        ```mermaid
        graph LR
            J[社内ユーザー] --> I[Firebase Hosting - 社内Web App/Dashboard]
            I --> D[Firestore - Recordings Collection]
            I --> H[Firestore - AnalysisResults Collection]
        ```
2.  **2-2: 基本的なファイルエラーハンドリングと手動復旧サポート:**
    *   **機能:** エラー発生時、対象ファイルをCloud Storage内のエラー専用領域へ移動。管理者がエラー内容を確認し、再処理を試行できる（またはステータスを更新できる）簡易的な仕組みの検討（例: 特定のメタデータをFirestoreで更新することで再処理をトリガー）。
3.  **2-3: 社内実運用とフィードバック収集:**
    *   社内チームによる日常業務での利用と、定期的なフィードバックセッションの実施。

**技術スタック (GCP - 追加):** Firebase Hosting, Firebase Authentication (社内ユーザー認証用).
**このフェーズにおける主要評価指標 (KPI):** 社内ユーザーのアクティブ率、ダッシュボード利用頻度、収集されたフィードバックの質と量、エラー発生時の検知と対応の迅速性。

---

### フェーズ3: 商用化に向けたSaaS基盤構築 (期間: 約1.5〜2ヶ月)

**目標:**
*   マルチテナント対応可能なSaaSアーキテクチャの基盤を設計・実装する。
*   顧客向けの初期ダッシュボード機能と、より高度なファイル管理・復旧機能を開発する。
*   テストスイートを拡充し、品質保証体制を強化する。

**主要機能とアーキテクチャ要素:**
1.  **3-1: マルチテナントアーキテクチャ設計・実装:**
    *   **機能:** Firebase Authenticationを利用した顧客ごとの認証基盤。Firestoreのセキュリティルールとデータモデリングによる顧客データの論理的な分離。
    *   **アーキテクチャ (概念):**
        ```mermaid
        graph TD
            K[顧客ユーザー] --> L[Firebase Authentication]
            L --> M[API - Cloud Functions/Run]
            M --> N[Firestore - テナント別データ]
            M --> O[Cloud Storage - テナント別バケット/プレフィックス]
        ```
2.  **3-2: 顧客向け初期ダッシュボード機能開発:**
    *   **機能:** 顧客が自身の商談データ（文字起こし、基本分析結果）を閲覧・検索できるダッシュボード。
3.  **3-3: 高度なファイル管理・復旧機能の実装 (一部):**
    *   **機能:** Cloud Tasksを活用したエラー発生時の自動リトライ処理の実装。Cloud Schedulerによる定期的な処理ステータスのチェックやクリーンアップタスクの準備。
4.  **3-4: テストスイートの拡充:**
    *   主要機能に対するインテグレーションテスト、GCPサービス連携部分のテストを実装。

**技術スタック (GCP - 追加):** Cloud Tasks, Cloud Scheduler.
**このフェーズにおける主要評価指標 (KPI):** マルチテナント分離の設計妥当性、初期ダッシュボードのユーザビリティ（設計レビュー）、自動リトライ成功率。

---

### フェーズ4: テストマーケティングおよび機能拡張 (期間: 約2〜2.5ヶ月)

**目標:**
*   一部の協力顧客に対して限定的にサービスを提供し、実環境でのフィードバックを収集する。
*   顧客フィードバックに基づき、ダッシュボード機能の拡張やユーザビリティ改善を行う。
*   課金システム連携や利用規約整備など、商用提供に必要な準備を完了する。

**主要機能とアーキテクチャ要素:**
1.  **4-1: 顧客向け高機能分析ダッシュボード開発:**
    *   **機能:** 担当者別・案件別のKPI表示、重要キーワードのトレンド分析、フィルタリング機能など、より高度な分析機能と可視化オプションをダッシュボードに追加。(Looker Studio連携またはカスタムフロントエンドでのリッチな表現を検討)
    *   **アーキテクチャ (可視化部分):**
        ```mermaid
        graph TD
            N[Firestore - テナント別データ] --> P[データ連携/集計処理]
            P --> Q[Looker Studio または カスタムダッシュボードUI]
            K[顧客ユーザー] --> Q
        ```
2.  **4-2: セキュリティ強化と各種規約整備:**
    *   **機能:** GCPのセキュリティ機能（Identity Platformの高度な機能、Security Command Centerの活用検討）によるセキュリティ強化。利用規約、プライバシーポリシーの整備。
3.  **4-3: 課金システム連携準備:**
    *   Stripe等の外部課金サービスとの連携インターフェースの準備。
4.  **4-4: 特定業界向けテンプレートの初期実装:**
    *   例: 教育業界向け分析テンプレートのダッシュボードへの初期反映。
5.  **4-5: 限定顧客への提供とフィードバックループ確立:**
    *   協力顧客へのサービス提供、利用状況モニタリング、定期的なヒアリングの実施。

**技術スタック (GCP - 追加/強化):** Looker Studio (またはカスタムBIツール), API Gateway (顧客向けAPI提供検討時).
**このフェーズにおける主要評価指標 (KPI):** テストマーケティング参加顧客数、アクティブユーザー率、顧客満足度調査結果、機能要望の収集数、有料プランへの転換意向。

--- 