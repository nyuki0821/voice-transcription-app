# クライアントマスターデータ設定ガイド

## 概要
このドキュメントでは、音声文字起こしアプリでクライアント名を動的に管理するための設定方法を説明します。

## 設定手順

### 1. スプレッドシートの準備

1. Google スプレッドシートで新しいスプレッドシートを作成します
2. シート名を「クライアントマスタ」に変更します
3. 1行目にヘッダーを設定します（A列: `telephone_number`、B列: `company_name`）
4. 2行目以降のB列に、営業会社名を入力します

例：
```
| A列              | B列                           |
|------------------|-------------------------------|
| telephone_number | company_name                  |
| (電話番号)       | 株式会社ENERALL               |
| (電話番号)       | エムスリーヘルスデザイン株式会社 |
| (電話番号)       | 株式会社TOKIUM                |
| ...              | ...                           |
```

**注意**: システムはB列（`company_name`）のデータのみを読み取ります。A列の電話番号は参考情報として使用できます。

### 2. スプレッドシートIDの取得

1. スプレッドシートのURLから、スプレッドシートIDを取得します
   - URL例: `https://docs.google.com/spreadsheets/d/[スプレッドシートID]/edit`
   - `[スプレッドシートID]`の部分がスプレッドシートIDです

### 3. Apps Scriptプロジェクトの設定

1. Apps Scriptエディタを開きます
2. 「プロジェクトの設定」を選択します
3. 「スクリプトプロパティ」セクションで「プロパティを追加」をクリックします
4. 以下のプロパティを追加します：
   - プロパティ名: `CLIENT_MASTER_SPREADSHEET_ID`
   - 値: 取得したスプレッドシートID

### 4. 権限の設定

スプレッドシートへのアクセス権限を確認します：
- Apps Scriptプロジェクトがスプレッドシートを読み取れることを確認してください
- 必要に応じて、スプレッドシートの共有設定を調整してください

## 会社名のエイリアス（別名）について

システムは自動的に以下のエイリアスを生成します：
- 「株式会社」を除いた形（例：「株式会社ENERALL」→「ENERALL」）
- 特定の会社については、読み方や略称も自動的に認識されます

### カスタムエイリアスの追加

特定の会社に対して追加のエイリアスが必要な場合は、`ClientMasterDataLoader.js`の`generateCompanyAliases`関数内の`specialAliases`オブジェクトを編集してください。

## トラブルシューティング

### エラー：「CLIENT_MASTER_SPREADSHEET_IDがスクリプトプロパティに設定されていません」
- スクリプトプロパティが正しく設定されているか確認してください

### エラー：「B列（company_name列）が存在しません」
- スプレッドシートのB列（2列目）に`company_name`というヘッダーがあることを確認してください
- ヘッダーが`company_name`でない場合でも、B列にデータがあれば自動的にB列を使用します

### スプレッドシートが読み込めない場合
- スプレッドシートIDが正しいか確認してください
- Apps Scriptプロジェクトがスプレッドシートにアクセスできる権限があるか確認してください

## キャッシュについて

- クライアントデータは1時間キャッシュされます
- 即座に変更を反映させたい場合は、Apps Scriptエディタから`ClientMasterDataLoader.clearCache()`を実行してください 